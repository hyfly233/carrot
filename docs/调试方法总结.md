# Carrot YARN é¡¹ç›®è°ƒè¯•æ–¹æ³•æ€»ç»“

## ğŸ¯ å¿«é€Ÿå¼€å§‹è°ƒè¯•

### 1. åŸºæœ¬ç¯å¢ƒæ£€æŸ¥

```bash
# æ£€æŸ¥ Go ç‰ˆæœ¬
go version

# æ£€æŸ¥é¡¹ç›®ç¼–è¯‘
make build

# è¿è¡ŒåŸºæœ¬æµ‹è¯•
go test ./...
```

### 2. å•å…ƒæµ‹è¯•è°ƒè¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•å¹¶æ˜¾ç¤ºè¯¦ç»†è¾“å‡º
go test -v ./...

# è¿è¡Œç‰¹å®šç»„ä»¶æµ‹è¯•
go test -v ./internal/resourcemanager
go test -v ./internal/nodemanager

# è¿è¡Œç‰¹å®šæµ‹è¯•å‡½æ•°
go test -v ./internal/resourcemanager -run TestResourceManagerCreation

# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
go test -coverprofile=out/coverage.out ./...
go tool cover -html=out/coverage.out -o out/coverage.html
```

### 3. æ€§èƒ½è°ƒè¯•

```bash
# è¿è¡ŒåŸºå‡†æµ‹è¯•
go test -bench=. -benchmem ./internal/resourcemanager
go test -bench=. -benchmem ./internal/nodemanager

# ç”Ÿæˆ CPU æ€§èƒ½åˆ†æ
go test -bench=. -cpuprofile=cpu.prof ./internal/resourcemanager
go tool pprof cpu.prof

# ç”Ÿæˆå†…å­˜åˆ†æ
go test -bench=. -memprofile=mem.prof ./internal/resourcemanager
go tool pprof mem.prof
```

### 4. é›†æˆæµ‹è¯•è°ƒè¯•

```bash
# è¿è¡Œé›†æˆæµ‹è¯•
./scripts/integration-test.sh

# å¯åŠ¨è°ƒè¯•ç¯å¢ƒ
./scripts/debug.sh

# æ€§èƒ½åˆ†æ
./scripts/performance-analysis.sh
```

## ğŸ”§ IDE è°ƒè¯•é…ç½®

### VS Code è°ƒè¯•

1. å®‰è£… Go æ‰©å±•
2. ä½¿ç”¨é¡¹ç›®ä¸­çš„ `.vscode/launch.json` é…ç½®
3. è®¾ç½®æ–­ç‚¹
4. æŒ‰ F5 å¼€å§‹è°ƒè¯•

### GoLand/IntelliJ è°ƒè¯•

1. æ‰“å¼€é¡¹ç›®
2. å³é”®ç‚¹å‡» `main.go` æ–‡ä»¶
3. é€‰æ‹© "Debug 'go build main.go'"
4. åœ¨ Run Configuration ä¸­è®¾ç½®å‚æ•°

## ğŸ› ï¸ å‘½ä»¤è¡Œè°ƒè¯•

### ä½¿ç”¨ Delve è°ƒè¯•å™¨

```bash
# å®‰è£… Delve
go install github.com/go-delve/delve/cmd/dlv@latest

# è°ƒè¯• ResourceManager
dlv debug cmd/resourcemanager/main.go -- -port 8088

# è°ƒè¯• NodeManager
dlv debug cmd/nodemanager/main.go -- -port 8042 -host localhost -rm-url http://localhost:8088

# è¿æ¥åˆ°è¿è¡Œä¸­çš„è¿›ç¨‹
dlv attach <PID>

# è¿œç¨‹è°ƒè¯•
dlv --listen=:2345 --headless=true --api-version=2 debug cmd/resourcemanager/main.go
```

### Delve è°ƒè¯•å‘½ä»¤

```
(dlv) break main.main                    # åœ¨ main å‡½æ•°è®¾ç½®æ–­ç‚¹
(dlv) break internal/resourcemanager.(*ResourceManager).Start  # åœ¨æ–¹æ³•è®¾ç½®æ–­ç‚¹
(dlv) continue                           # ç»§ç»­æ‰§è¡Œ
(dlv) next                              # ä¸‹ä¸€è¡Œ
(dlv) step                              # æ­¥å…¥
(dlv) print variable_name               # æ‰“å°å˜é‡
(dlv) locals                            # æ˜¾ç¤ºå±€éƒ¨å˜é‡
(dlv) goroutines                        # æ˜¾ç¤º goroutine
(dlv) stack                             # æ˜¾ç¤ºè°ƒç”¨æ ˆ
```

## ğŸ“Š æ—¥å¿—è°ƒè¯•

### å¯ç”¨è¯¦ç»†æ—¥å¿—

```bash
# è®¾ç½®ç¯å¢ƒå˜é‡
export LOG_LEVEL=DEBUG
export CARROT_DEBUG=true

# å¯åŠ¨æœåŠ¡
./bin/resourcemanager -port 8088
./bin/nodemanager -port 8042 -host localhost -rm-url http://localhost:8088
```

### æ—¥å¿—åˆ†æ

```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
tail -f logs/*.log

# æœç´¢é”™è¯¯
grep -i error logs/*.log
grep -i "failed\|error\|panic" logs/*.log

# æŒ‰æ—¶é—´æŸ¥çœ‹æ—¥å¿—
ls -lt logs/ | head -10
```

## ğŸŒ ç½‘ç»œè°ƒè¯•

### HTTP API è°ƒè¯•

```bash
# æ£€æŸ¥é›†ç¾¤çŠ¶æ€
curl -v http://localhost:8088/ws/v1/cluster/info

# æŸ¥çœ‹èŠ‚ç‚¹ä¿¡æ¯
curl -s http://localhost:8088/ws/v1/cluster/nodes | jq .

# æŸ¥çœ‹åº”ç”¨çŠ¶æ€
curl -s http://localhost:8088/ws/v1/cluster/apps | jq .

# æµ‹è¯•åº”ç”¨æäº¤
curl -X POST -H "Content-Type: application/json" \
     -d '{"application_name": "test", "commands": ["echo test"]}' \
     http://localhost:8088/ws/v1/cluster/apps
```

### ç½‘ç»œè¿æ¥è°ƒè¯•

```bash
# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :8088
lsof -i :8042
netstat -tlnp | grep -E '8088|8042'

# æµ‹è¯•ç½‘ç»œè¿é€šæ€§
telnet localhost 8088
nc -zv localhost 8088

# ç½‘ç»œæŠ“åŒ…
sudo tcpdump -i lo -w debug.pcap port 8088
```

## ğŸ” ç³»ç»Ÿçº§è°ƒè¯•

### è¿›ç¨‹è°ƒè¯•

```bash
# æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€
ps aux | grep -E 'resourcemanager|nodemanager'

# æŸ¥çœ‹è¿›ç¨‹æ ‘
pstree -p

# ç³»ç»Ÿè°ƒç”¨è·Ÿè¸ª
strace -o trace.log ./bin/resourcemanager -port 8088
```

### èµ„æºç›‘æ§

```bash
# CPU å’Œå†…å­˜ä½¿ç”¨
top -p <PID>
htop

# æ–‡ä»¶æè¿°ç¬¦
lsof -p <PID>

# ç³»ç»Ÿè´Ÿè½½
uptime
vmstat 1
iostat 1
```
