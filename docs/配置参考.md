# Carrot YARN é…ç½®å‚è€ƒ

æœ¬æ–‡æ¡£æä¾› Carrot YARN æ‰€æœ‰ç»„ä»¶çš„å®Œæ•´é…ç½®å‚è€ƒã€‚

## ğŸ“‹ ç›®å½•

- [é€šç”¨é…ç½®](#é€šç”¨é…ç½®)
- [ResourceManager é…ç½®](#resourcemanager-é…ç½®)
- [NodeManager é…ç½®](#nodemanager-é…ç½®)
- [ApplicationMaster é…ç½®](#applicationmaster-é…ç½®)
- [è°ƒåº¦å™¨é…ç½®](#è°ƒåº¦å™¨é…ç½®)
- [å®‰å…¨é…ç½®](#å®‰å…¨é…ç½®)
- [ç›‘æ§é…ç½®](#ç›‘æ§é…ç½®)
- [ç½‘ç»œé…ç½®](#ç½‘ç»œé…ç½®)
- [ç¯å¢ƒå˜é‡](#ç¯å¢ƒå˜é‡)
- [é…ç½®ç¤ºä¾‹](#é…ç½®ç¤ºä¾‹)

## ğŸŒ é€šç”¨é…ç½®

### åŸºç¡€é…ç½®

| é…ç½®é¡¹            | ç±»å‹     | é»˜è®¤å€¼                | æè¿°                              |
|----------------|--------|--------------------|---------------------------------|
| `cluster.name` | string | `"carrot-cluster"` | é›†ç¾¤åç§°                            |
| `cluster.id`   | string | `""`               | é›†ç¾¤å”¯ä¸€æ ‡è¯†ç¬¦                         |
| `data.dir`     | string | `"/tmp/carrot"`    | æ•°æ®å­˜å‚¨ç›®å½•                          |
| `temp.dir`     | string | `"/tmp"`           | ä¸´æ—¶æ–‡ä»¶ç›®å½•                          |
| `log.level`    | string | `"info"`           | æ—¥å¿—çº§åˆ« (debug, info, warn, error) |
| `log.format`   | string | `"json"`           | æ—¥å¿—æ ¼å¼ (text, json)               |

### ç½‘ç»œé…ç½®

| é…ç½®é¡¹                       | ç±»å‹       | é»˜è®¤å€¼         | æè¿°     |
|---------------------------|----------|-------------|--------|
| `network.bind.host`       | string   | `"0.0.0.0"` | ç»‘å®šä¸»æœºåœ°å€ |
| `network.publish.host`    | string   | `""`        | å‘å¸ƒä¸»æœºåœ°å€ |
| `network.timeout.connect` | duration | `"30s"`     | è¿æ¥è¶…æ—¶æ—¶é—´ |
| `network.timeout.read`    | duration | `"30s"`     | è¯»å–è¶…æ—¶æ—¶é—´ |
| `network.timeout.write`   | duration | `"30s"`     | å†™å…¥è¶…æ—¶æ—¶é—´ |

### èµ„æºé…ç½®

| é…ç½®é¡¹                       | ç±»å‹     | é»˜è®¤å€¼      | æè¿°          |
|---------------------------|--------|----------|-------------|
| `resource.memory.minimum` | string | `"512m"` | æœ€å°å†…å­˜åˆ†é…å•ä½    |
| `resource.cpu.minimum`    | float  | `0.1`    | æœ€å° CPU åˆ†é…å•ä½ |
| `resource.memory.maximum` | string | `"8g"`   | æœ€å¤§å†…å­˜åˆ†é…å•ä½    |
| `resource.cpu.maximum`    | float  | `8.0`    | æœ€å¤§ CPU åˆ†é…å•ä½ |

## ğŸ¢ ResourceManager é…ç½®

### æœåŠ¡é…ç½®

```yaml
resourcemanager:
  # æœåŠ¡å™¨é…ç½®
  server:
    host: "0.0.0.0"
    port: 8088

    # TLS é…ç½®
    tls:
      enabled: false
      cert_file: ""
      key_file: ""
      ca_file: ""

  # åº”ç”¨ç¨‹åºé…ç½®
  application:
    # æœ€å¤§è¿è¡Œåº”ç”¨ç¨‹åºæ•°
    max_running_apps: 1000
    # æœ€å¤§å¾…å¤„ç†åº”ç”¨ç¨‹åºæ•°
    max_pending_apps: 500
    # åº”ç”¨ç¨‹åºè¿‡æœŸæ—¶é—´
    expiry_time: "7d"
    # åº”ç”¨ç¨‹åºæ¸…ç†é—´éš”
    cleanup_interval: "1h"

  # èŠ‚ç‚¹é…ç½®
  node:
    # å¿ƒè·³é—´éš”
    heartbeat_interval: "1s"
    # å¿ƒè·³è¶…æ—¶
    heartbeat_timeout: "10m"
    # ä¸å¥åº·èŠ‚ç‚¹æ¸…ç†é—´éš”
    cleanup_interval: "10m"
    # åŒ…å«æ¨¡å¼
    include_pattern: ""
    # æ’é™¤æ¨¡å¼
    exclude_pattern: ""

  # è°ƒåº¦å™¨é…ç½®
  scheduler:
    # è°ƒåº¦å™¨ç±»å‹: fifo, capacity, fair
    type: "capacity"
    # è°ƒåº¦é—´éš”
    schedule_interval: "100ms"
    # æœ€å¤§åˆ†é…å°è¯•æ¬¡æ•°
    max_allocation_attempts: 3
    # è°ƒåº¦å™¨é…ç½®æ–‡ä»¶
    config_file: "configs/capacity-scheduler.xml"

  # æ¢å¤é…ç½®
  recovery:
    # æ˜¯å¦å¯ç”¨æ¢å¤
    enabled: true
    # çŠ¶æ€å­˜å‚¨ç±»å‹: memory, file, etcd
    store_type: "file"
    # å­˜å‚¨ç›®å½•
    store_dir: "data/rm-state"
    # æ¢å¤è¶…æ—¶
    timeout: "60s"

  # å®‰å…¨é…ç½®
  security:
    # æ˜¯å¦å¯ç”¨å®‰å…¨
    enabled: false
    # è®¤è¯ç±»å‹: simple, kerberos, jwt
    auth_type: "simple"
    # ACL å¯ç”¨
    acl_enabled: false
    # ç®¡ç†å‘˜ç”¨æˆ·
    admin_users: [ "admin" ]
    # ç®¡ç†å‘˜ç»„
    admin_groups: [ "admin" ]
```

### ç¯å¢ƒå˜é‡

| ç¯å¢ƒå˜é‡           | é»˜è®¤å€¼         | æè¿°                   |
|----------------|-------------|----------------------|
| `RM_HOST`      | `localhost` | ResourceManager ä¸»æœºåœ°å€ |
| `RM_PORT`      | `8088`      | ResourceManager ç«¯å£   |
| `RM_HEAP_SIZE` | `1024m`     | JVM å †å¤§å°              |
| `RM_LOG_LEVEL` | `info`      | æ—¥å¿—çº§åˆ«                 |

## ğŸ–¥ï¸ NodeManager é…ç½®

### æœåŠ¡é…ç½®

```yaml
nodemanager:
  # æœåŠ¡å™¨é…ç½®
  server:
    host: "0.0.0.0"
    port: 8042

    # TLS é…ç½®
    tls:
      enabled: false
      cert_file: ""
      key_file: ""
      ca_file: ""

  # ResourceManager è¿æ¥é…ç½®
  resourcemanager:
    host: "localhost"
    port: 8088
    # è¿æ¥é‡è¯•æ¬¡æ•°
    connect_retries: 3
    # è¿æ¥é‡è¯•é—´éš”
    retry_interval: "5s"

  # èŠ‚ç‚¹èµ„æºé…ç½®
  resources:
    # å†…å­˜èµ„æº (MB)
    memory: 8192
    # CPU èµ„æº (vCores)
    vcores: 8
    # æ˜¯å¦æ£€æµ‹ç‰©ç†èµ„æº
    detect_hardware: true
    # å†…å­˜ä½¿ç”¨ç‡é˜ˆå€¼
    memory_threshold: 0.8
    # CPU ä½¿ç”¨ç‡é˜ˆå€¼
    cpu_threshold: 0.8

  # å®¹å™¨é…ç½®
  containers:
    # æ‰§è¡Œå™¨ç±»å‹: default, linux
    executor_type: "default"
    # æœ€å¤§å®¹å™¨æ•°
    max_containers: 100
    # å®¹å™¨å†…å­˜æœ€å°å€¼
    min_memory: 512
    # å®¹å™¨å†…å­˜æœ€å¤§å€¼
    max_memory: 8192
    # å®¹å™¨å¯åŠ¨è¶…æ—¶
    launch_timeout: "60s"
    # å®¹å™¨æ¸…ç†é—´éš”
    cleanup_interval: "10m"

  # æœ¬åœ°åŒ–é…ç½®
  localizer:
    # æœ¬åœ°ç¼“å­˜ç›®å½•
    cache_dir: "cache"
    # ç¼“å­˜å¤§å°é™åˆ¶
    cache_size_limit: "10g"
    # ç¼“å­˜æ¸…ç†é—´éš”
    cleanup_interval: "1h"
    # å¹¶å‘ä¸‹è½½æ•°
    concurrent_downloads: 5
    # ä¸‹è½½è¶…æ—¶
    download_timeout: "10m"

  # å¥åº·æ£€æŸ¥é…ç½®
  health:
    # æ£€æŸ¥é—´éš”
    check_interval: "30s"
    # ç£ç›˜æ£€æŸ¥
    disk_check_enabled: true
    # ç£ç›˜ä½¿ç”¨ç‡é˜ˆå€¼
    disk_threshold: 0.9
    # å†…å­˜æ£€æŸ¥
    memory_check_enabled: true
    # CPU æ£€æŸ¥
    cpu_check_enabled: true

  # ç›‘æ§é…ç½®
  monitoring:
    # æ˜¯å¦å¯ç”¨ç›‘æ§
    enabled: true
    # ç›‘æ§é—´éš”
    interval: "10s"
    # å†å²æ•°æ®ä¿ç•™æ—¶é—´
    retention: "24h"
    # æŒ‡æ ‡å­˜å‚¨ç›®å½•
    metrics_dir: "metrics"

  # å®‰å…¨é…ç½®
  security:
    # æ˜¯å¦å¯ç”¨å®‰å…¨
    enabled: false
    # è¿è¡Œç”¨æˆ·æ£€æŸ¥
    check_user: false
    # å®¹å™¨ç”¨æˆ·
    container_user: "nobody"
```

### ç¯å¢ƒå˜é‡

| ç¯å¢ƒå˜é‡           | é»˜è®¤å€¼         | æè¿°               |
|----------------|-------------|------------------|
| `NM_HOST`      | `localhost` | NodeManager ä¸»æœºåœ°å€ |
| `NM_PORT`      | `8042`      | NodeManager ç«¯å£   |
| `NM_MEMORY`    | `8192`      | èŠ‚ç‚¹å†…å­˜å¤§å° (MB)      |
| `NM_VCORES`    | `8`         | èŠ‚ç‚¹ CPU æ ¸å¿ƒæ•°       |
| `NM_HEAP_SIZE` | `1024m`     | JVM å †å¤§å°          |

## ğŸ“± ApplicationMaster é…ç½®

### æœåŠ¡é…ç½®

```yaml
applicationmaster:
  # æœåŠ¡å™¨é…ç½®
  server:
    host: "0.0.0.0"
    port: 8080

    # TLS é…ç½®
    tls:
      enabled: false
      cert_file: ""
      key_file: ""
      ca_file: ""

  # ResourceManager è¿æ¥é…ç½®
  resourcemanager:
    host: "localhost"
    port: 8088
    # æ³¨å†Œé‡è¯•æ¬¡æ•°
    register_retries: 3
    # æ³¨å†Œé‡è¯•é—´éš”
    retry_interval: "5s"
    # å¿ƒè·³é—´éš”
    heartbeat_interval: "1s"

  # å®¹å™¨é…ç½®
  containers:
    # æœ€å¤§å®¹å™¨è¯·æ±‚æ•°
    max_container_requests: 1000
    # å®¹å™¨è¯·æ±‚é—´éš”
    request_interval: "100ms"
    # å®¹å™¨é‡Šæ”¾è¶…æ—¶
    release_timeout: "30s"

  # ä»»åŠ¡é…ç½®
  tasks:
    # æœ€å¤§é‡è¯•æ¬¡æ•°
    max_retries: 3
    # é‡è¯•é—´éš”
    retry_interval: "10s"
    # ä»»åŠ¡è¶…æ—¶
    timeout: "30m"

  # åº”ç”¨ç¨‹åºé…ç½®
  application:
    # åº”ç”¨ç¨‹åºç±»å‹
    type: "simple"
    # ä¸»ç±»å
    main_class: ""
    # åº”ç”¨ç¨‹åºå‚æ•°
    args: [ ]
    # ç¯å¢ƒå˜é‡
    env: { }
```

### ç¯å¢ƒå˜é‡

| ç¯å¢ƒå˜é‡           | é»˜è®¤å€¼         | æè¿°                     |
|----------------|-------------|------------------------|
| `AM_HOST`      | `localhost` | ApplicationMaster ä¸»æœºåœ°å€ |
| `AM_PORT`      | `8080`      | ApplicationMaster ç«¯å£   |
| `AM_HEAP_SIZE` | `512m`      | JVM å †å¤§å°                |
| `RM_HOST`      | `localhost` | ResourceManager ä¸»æœºåœ°å€   |
| `RM_PORT`      | `8088`      | ResourceManager ç«¯å£     |

## ğŸ“Š è°ƒåº¦å™¨é…ç½®

### FIFO è°ƒåº¦å™¨

```yaml
scheduler:
    type: "fifo"
    config:
        # ç”¨æˆ·é™åˆ¶
        user_limit_factor: 1.0
        # æœ€å¤§åº”ç”¨ç¨‹åºæ•°
        max_applications: 1000
```

### Capacity è°ƒåº¦å™¨

```xml
<!-- configs/capacity-scheduler.xml -->
<configuration>
  <!-- é˜Ÿåˆ—å®šä¹‰ -->
  <property>
    <name>yarn.scheduler.capacity.resource-calculator</name>
    <value>org.apache.hadoop.yarn.util.resource.DefaultResourceCalculator</value>
  </property>

  <property>
    <name>yarn.scheduler.capacity.root.queues</name>
    <value>default,development,production</value>
  </property>

  <!-- é»˜è®¤é˜Ÿåˆ— -->
  <property>
    <name>yarn.scheduler.capacity.root.default.capacity</name>
    <value>40</value>
  </property>

  <property>
    <name>yarn.scheduler.capacity.root.default.maximum-capacity</name>
    <value>60</value>
  </property>

  <property>
    <name>yarn.scheduler.capacity.root.default.user-limit-factor</name>
    <value>1</value>
  </property>

  <!-- å¼€å‘é˜Ÿåˆ— -->
  <property>
    <name>yarn.scheduler.capacity.root.development.capacity</name>
    <value>20</value>
  </property>

  <property>
    <name>yarn.scheduler.capacity.root.development.maximum-capacity</name>
    <value>40</value>
  </property>

  <!-- ç”Ÿäº§é˜Ÿåˆ— -->
  <property>
    <name>yarn.scheduler.capacity.root.production.capacity</name>
    <value>40</value>
  </property>

  <property>
    <name>yarn.scheduler.capacity.root.production.maximum-capacity</name>
    <value>80</value>
  </property>
</configuration>
```

### Fair è°ƒåº¦å™¨

```xml
<!-- configs/fair-scheduler.xml -->
<allocations>
  <!-- é»˜è®¤é˜Ÿåˆ—è®¾ç½® -->
  <queueMaxAMShareDefault>0.5</queueMaxAMShareDefault>
  <queueMaxResourcesDefault>40gb,10vcores</queueMaxResourcesDefault>

  <!-- é˜Ÿåˆ—å®šä¹‰ -->
  <queue name="sample_queue">
    <minResources>10000mb,0vcores</minResources>
    <maxResources>90000mb,0vcores</maxResources>
    <maxRunningApps>50</maxRunningApps>
    <weight>2.0</weight>
    <schedulingPolicy>fair</schedulingPolicy>

    <queue name="sample_sub_queue">
      <aclSubmitApps>charlie</aclSubmitApps>
      <minResources>5000mb,0vcores</minResources>
    </queue>
  </queue>

  <!-- ç”¨æˆ·è®¾ç½® -->
  <user name="sample_user">
    <maxRunningApps>30</maxRunningApps>
  </user>

  <!-- é˜Ÿåˆ—æ”¾ç½®ç­–ç•¥ -->
  <queuePlacementPolicy>
    <rule name="specified" />
    <rule name="primaryGroup" create="false" />
    <rule name="default" queue="sample_queue"/>
  </queuePlacementPolicy>
</allocations>
```

## ğŸ” å®‰å…¨é…ç½®

### è®¤è¯é…ç½®

```yaml
security:
    # è®¤è¯é…ç½®
    authentication:
        # è®¤è¯ç±»å‹: simple, jwt, kerberos
        type: "simple"

        # JWT é…ç½®
        jwt:
            secret_key: "your-secret-key"
            expiration: "24h"
            issuer: "carrot-yarn"

        # Kerberos é…ç½®
        kerberos:
            principal: "yarn/_HOST@REALM"
            keytab: "/etc/yarn.keytab"
            realm: "REALM"

    # æˆæƒé…ç½®
    authorization:
        # æ˜¯å¦å¯ç”¨ ACL
        enabled: false

        # ç®¡ç†å‘˜ ACL
        admin_acl:
            users: ["admin"]
            groups: ["admin"]

        # é˜Ÿåˆ— ACL
        queue_acl:
            default:
                submit_users: ["*"]
                submit_groups: ["*"]
                admin_users: ["admin"]
                admin_groups: ["admin"]

    # TLS é…ç½®
    tls:
        # æ˜¯å¦å¯ç”¨ TLS
        enabled: false

        # è¯ä¹¦é…ç½®
        cert_file: "/etc/ssl/certs/yarn.crt"
        key_file: "/etc/ssl/private/yarn.key"
        ca_file: "/etc/ssl/certs/ca.crt"

        # å¯†ç å¥—ä»¶
        cipher_suites: []

        # æœ€å° TLS ç‰ˆæœ¬
        min_version: "1.2"
```

### è®¿é—®æ§åˆ¶

```yaml
acl:
    # åº”ç”¨ç¨‹åºæäº¤ ACL
    submit_application:
        users: ["user1", "user2"]
        groups: ["group1", "group2"]

    # åº”ç”¨ç¨‹åºç®¡ç† ACL
    admin_application:
        users: ["admin"]
        groups: ["admin"]

    # é›†ç¾¤ç®¡ç† ACL
    admin_cluster:
        users: ["admin"]
        groups: ["admin"]

    # é˜Ÿåˆ—ç®¡ç† ACL
    admin_queue:
        users: ["admin"]
        groups: ["admin"]
```

## ğŸ“ˆ ç›‘æ§é…ç½®

### Prometheus é…ç½®

```yaml
monitoring:
    # Prometheus é…ç½®
    prometheus:
        # æ˜¯å¦å¯ç”¨
        enabled: true

        # ç›‘å¬åœ°å€
        host: "0.0.0.0"
        port: 9090

        # æŒ‡æ ‡è·¯å¾„
        metrics_path: "/metrics"

        # é‡‡é›†é—´éš”
        scrape_interval: "15s"

        # æŒ‡æ ‡ä¿ç•™æ—¶é—´
        retention: "15d"

    # Grafana é…ç½®
    grafana:
        # æ˜¯å¦å¯ç”¨
        enabled: true

        # ç›‘å¬åœ°å€
        host: "0.0.0.0"
        port: 3000

        # æ•°æ®æºé…ç½®
        datasource:
            url: "http://localhost:9090"
            type: "prometheus"

    # æ—¥å¿—é…ç½®
    logging:
        # æ—¥å¿—çº§åˆ«
        level: "info"

        # æ—¥å¿—æ ¼å¼: text, json
        format: "json"

        # æ—¥å¿—è¾“å‡º: stdout, file
        output: "stdout"

        # æ—¥å¿—æ–‡ä»¶
        file: "/var/log/carrot/app.log"

        # æ—¥å¿—è½®è½¬
        rotation:
            max_size: "100m"
            max_age: "7d"
            max_backups: 10
```

### å‘Šè­¦é…ç½®

```yaml
alerting:
  # å‘Šè­¦è§„åˆ™
  rules:
    - name: "cluster_health"
      rules:
        - alert: "NodeDown"
          expr: 'up{job="nodemanager"} == 0'
          for: "1m"
          labels:
            severity: "critical"
          annotations:
            summary: "NodeManager is down"

        - alert: "HighMemoryUsage"
          expr: "memory_usage_percent > 90"
          for: "5m"
          labels:
            severity: "warning"
          annotations:
            summary: "High memory usage detected"

  # é€šçŸ¥é…ç½®
  notifications:
    # é‚®ä»¶é€šçŸ¥
    email:
      enabled: false
      smtp_server: "smtp.example.com"
      smtp_port: 587
      username: "alerts@example.com"
      password: "password"

    # Slack é€šçŸ¥
    slack:
      enabled: false
      webhook_url: "https://hooks.slack.com/services/..."
      channel: "#alerts"
```

## ğŸŒ ç½‘ç»œé…ç½®

### ç«¯å£é…ç½®

| ç»„ä»¶                | é»˜è®¤ç«¯å£ | é…ç½®é¡¹                             | æè¿°          |
|-------------------|------|---------------------------------|-------------|
| ResourceManager   | 8088 | `resourcemanager.server.port`   | HTTP API ç«¯å£ |
| NodeManager       | 8042 | `nodemanager.server.port`       | HTTP API ç«¯å£ |
| ApplicationMaster | 8080 | `applicationmaster.server.port` | HTTP API ç«¯å£ |
| Prometheus        | 9090 | `monitoring.prometheus.port`    | ç›‘æ§æŒ‡æ ‡ç«¯å£      |
| Grafana           | 3000 | `monitoring.grafana.port`       | ç›‘æ§é¢æ¿ç«¯å£      |

### è´Ÿè½½å‡è¡¡é…ç½®

```yaml
load_balancer:
  # è´Ÿè½½å‡è¡¡å™¨ç±»å‹: nginx, haproxy, consul
  type: "nginx"

  # å¥åº·æ£€æŸ¥
  health_check:
    enabled: true
    path: "/health"
    interval: "30s"
    timeout: "5s"

  # ä¸Šæ¸¸æœåŠ¡å™¨
  upstream:
    resourcemanager:
      - "rm1.example.com:8088"
      - "rm2.example.com:8088"

    nodemanager:
      - "nm1.example.com:8042"
      - "nm2.example.com:8042"
```

## ğŸ”§ ç¯å¢ƒå˜é‡

### é€šç”¨ç¯å¢ƒå˜é‡

| å˜é‡å                | é»˜è®¤å€¼                 | æè¿°          |
|--------------------|---------------------|-------------|
| `CARROT_HOME`      | `/opt/carrot`       | Carrot å®‰è£…ç›®å½• |
| `CARROT_CONF_DIR`  | `$CARROT_HOME/conf` | é…ç½®æ–‡ä»¶ç›®å½•      |
| `CARROT_LOG_DIR`   | `$CARROT_HOME/logs` | æ—¥å¿—æ–‡ä»¶ç›®å½•      |
| `CARROT_PID_DIR`   | `/var/run/carrot`   | PID æ–‡ä»¶ç›®å½•    |
| `CARROT_HEAP_SIZE` | `1024m`             | JVM å †å¤§å°     |
| `CARROT_OPTS`      | `""`                | é¢å¤–çš„ JVM å‚æ•°  |

### ç»„ä»¶ç‰¹å®šç¯å¢ƒå˜é‡

#### ResourceManager

| å˜é‡å            | é»˜è®¤å€¼         | æè¿°                  |
|----------------|-------------|---------------------|
| `RM_HEAP_SIZE` | `2048m`     | ResourceManager å †å¤§å° |
| `RM_HOST`      | `localhost` | ResourceManager ä¸»æœº  |
| `RM_PORT`      | `8088`      | ResourceManager ç«¯å£  |

#### NodeManager

| å˜é‡å            | é»˜è®¤å€¼     | æè¿°              |
|----------------|---------|-----------------|
| `NM_HEAP_SIZE` | `1024m` | NodeManager å †å¤§å° |
| `NM_MEMORY`    | `8192`  | èŠ‚ç‚¹å†…å­˜ (MB)       |
| `NM_VCORES`    | `8`     | èŠ‚ç‚¹ CPU æ ¸å¿ƒæ•°      |

#### ApplicationMaster

| å˜é‡å            | é»˜è®¤å€¼    | æè¿°                    |
|----------------|--------|-----------------------|
| `AM_HEAP_SIZE` | `512m` | ApplicationMaster å †å¤§å° |
| `AM_MEMORY`    | `1024` | AM å®¹å™¨å†…å­˜ (MB)          |
| `AM_VCORES`    | `1`    | AM å®¹å™¨ CPU æ ¸å¿ƒæ•°         |

## ğŸ“ é…ç½®ç¤ºä¾‹

### å•èŠ‚ç‚¹å¼€å‘ç¯å¢ƒ

```yaml
# config.yaml
cluster:
  name: "dev-cluster"

resourcemanager:
  server:
    host: "localhost"
    port: 8088
  scheduler:
    type: "fifo"
  recovery:
    enabled: false

nodemanager:
  server:
    host: "localhost"
    port: 8042
  resourcemanager:
    host: "localhost"
    port: 8088
  resources:
    memory: 4096
    vcores: 4

monitoring:
  prometheus:
    enabled: true
    port: 9090
```

### å¤šèŠ‚ç‚¹ç”Ÿäº§ç¯å¢ƒ

```yaml
# config.yaml
cluster:
  name: "prod-cluster"

resourcemanager:
  server:
    host: "0.0.0.0"
    port: 8088
    tls:
      enabled: true
      cert_file: "/etc/ssl/certs/rm.crt"
      key_file: "/etc/ssl/private/rm.key"

  scheduler:
    type: "capacity"
    config_file: "configs/capacity-scheduler.xml"

  recovery:
    enabled: true
    store_type: "file"
    store_dir: "/data/rm-state"

  security:
    enabled: true
    auth_type: "jwt"

nodemanager:
  server:
    host: "0.0.0.0"
    port: 8042
    tls:
      enabled: true
      cert_file: "/etc/ssl/certs/nm.crt"
      key_file: "/etc/ssl/private/nm.key"

  resourcemanager:
    host: "rm.example.com"
    port: 8088

  resources:
    memory: 32768
    vcores: 16
    detect_hardware: true

  security:
    enabled: true
    check_user: true

monitoring:
  prometheus:
    enabled: true
    port: 9090
    retention: "30d"

  grafana:
    enabled: true
    port: 3000

alerting:
  rules:
    - name: "cluster_health"
      rules:
        - alert: "NodeDown"
          expr: 'up{job="nodemanager"} == 0'
          for: "1m"

  notifications:
    email:
      enabled: true
      smtp_server: "smtp.company.com"
      username: "alerts@company.com"
```

### Kubernetes ç¯å¢ƒ

```yaml
# k8s-config.yaml
cluster:
  name: "k8s-cluster"

resourcemanager:
  server:
    host: "0.0.0.0"
    port: 8088

  scheduler:
    type: "capacity"

  recovery:
    enabled: true
    store_type: "etcd"
    store_config:
      endpoints: [ "etcd:2379" ]

nodemanager:
  server:
    host: "0.0.0.0"
    port: 8042

  resourcemanager:
    host: "resourcemanager-service"
    port: 8088

  resources:
    detect_hardware: true

  containers:
    executor_type: "linux"

monitoring:
  prometheus:
    enabled: true
    port: 9090
```

## ğŸ” é…ç½®éªŒè¯

### é…ç½®æ£€æŸ¥å‘½ä»¤

```bash
# éªŒè¯é…ç½®æ–‡ä»¶è¯­æ³•
carrot config validate --config config.yaml

# æ£€æŸ¥é…ç½®å…¼å®¹æ€§
carrot config check --config config.yaml

# ç”Ÿæˆé»˜è®¤é…ç½®
carrot config generate --output default-config.yaml

# é…ç½®å·®å¼‚æ¯”è¾ƒ
carrot config diff --config1 config1.yaml --config2 config2.yaml
```

### é…ç½®æ¨¡æ¿

```bash
# ç”Ÿæˆå¼€å‘ç¯å¢ƒé…ç½®æ¨¡æ¿
carrot config template --env development

# ç”Ÿæˆç”Ÿäº§ç¯å¢ƒé…ç½®æ¨¡æ¿
carrot config template --env production

# ç”Ÿæˆ Kubernetes é…ç½®æ¨¡æ¿
carrot config template --env kubernetes
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [ğŸ—ï¸ ç³»ç»Ÿæ¶æ„](./ç³»ç»Ÿæ¶æ„.md) - ç³»ç»Ÿæ¶æ„è®¾è®¡
- [ğŸ”§ å¼€å‘æŒ‡å—](./å¼€å‘æŒ‡å—.md) - å¼€å‘ç¯å¢ƒé…ç½®
- [ğŸ“– æ ¸å¿ƒæ¦‚å¿µ](./æ ¸å¿ƒæ¦‚å¿µ.md) - ç†è§£é…ç½®èƒŒæ™¯
- [ğŸ“¦ å¿«é€Ÿå®‰è£…æŒ‡å—](./å¿«é€Ÿå®‰è£…æŒ‡å—.md) - éƒ¨ç½²é…ç½®
